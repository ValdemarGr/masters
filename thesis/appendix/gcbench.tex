
\begin{figure}
\begin{lstlisting}[breaklines=true,caption={A program that sums a list of 100000 increasing integers},label=lst:appedix:intsum]
type List a = 
  | Nil
  | Cons a (List a)
;

fun sum l =
  match l
    | Cons x xs ->
      x + (sum xs);
    | Nil -> 0;
  ;

fun range n s =
  if (n == s) 
    Nil;
  else
    (Cons s (range n (s + 1)));
  ;

fun inf from =
  Cons from (inf (from + 1));

fun take l n =
  if (n == 0) 
    Nil;
  else
    match l
      | Nil -> Nil;
      | Cons x xs -> Cons x (take xs (n - 1));
    ;
  ;

fun main =
  let garbage = range 100 0;
  let longlist = inf 1;
  sum (take longlist 100000);
\end{lstlisting}
\end{figure}
\begin{figure}
\begin{lstlisting}[breaklines=true,caption={A program which calculates the Fibonacci numbers recursively},label=lst:appedix:fib]
fun fib n = 
  if (n == 0)
    0;
  else
    if (n == 1)
      1;
    else
      (fib (n - 1)) + (fib (n - 2));
    ;
  ;

fun main = (fib 30);
\end{lstlisting}
\end{figure}
\begin{figure}
\begin{lstlisting}[breaklines=true,caption={foldl},label=lst:appendix:foldl]
type List a = 
  | Nil
  | Cons a (List a)
;

fun add a b = a + b;

fun foldl f z l =
  match l
    | Nil -> z;
    | Cons x xs ->
      foldl f (f x z) xs;
  ;

fun range n s =
  if (n == s) 
    Nil;
  else
    (Cons s (range n (s + 1)));
  ;

fun inf from =
  Cons from (inf (from + 1));

fun take l n =
  if (n == 0) 
    Nil;
  else
    match l
      | Nil -> Nil;
      | Cons x xs -> Cons x (take xs (n - 1));
    ;
  ;

fun main =
  let longlist = inf 1;
  foldl add 0 (take longlist 1000);

\end{lstlisting}
\end{figure}
\begin{figure}
\begin{lstlisting}[breaklines=true,caption={foldr},label=lst:appendix:foldr]
type List a = 
  | Nil
  | Cons a (List a)
;

fun add a b = a + b;

fun foldr f z l =
  match l
    | Nil -> z;
    | Cons x xs ->
      f x (foldr f z xs);
  ;

fun range n s =
  if (n == s) 
    Nil;
  else
    (Cons s (range n (s + 1)));
  ;

fun inf from =
  Cons from (inf (from + 1));

fun take l n =
  if (n == 0) 
    Nil;
  else
    match l
      | Nil -> Nil;
      | Cons x xs -> Cons x (take xs (n - 1));
    ;
  ;

fun main =
  let longlist = inf 1;
  foldr add 0 (take longlist 1000);

\end{lstlisting}
\end{figure}
